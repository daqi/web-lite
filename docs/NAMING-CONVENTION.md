# å‘½åè§„èŒƒ
â€œå‘½åè§„èŒƒâ€æ˜¯è½¯ä»¶å¼€å‘ä¸­ä¿è¯**ä¸€è‡´æ€§ã€å¯ç»´æŠ¤æ€§ã€å¯è¯»æ€§**çš„å…³é”®ã€‚ä¸‹é¢æˆ‘å°†ä¸ºä½ ç³»ç»Ÿæ€»ç»“å¼€å‘ä¸­çš„å‘½åè§„èŒƒï¼Œæ¶µç›–ï¼š

* ğŸ§© **æ•°æ®åº“å±‚ï¼ˆè¡¨ã€å­—æ®µã€ç±»å‹ï¼‰**
* ğŸ§  **ä»£ç å±‚ï¼ˆå˜é‡ã€å‡½æ•°ã€ç±»ï¼‰**
* ğŸŒ **æ¥å£å±‚ï¼ˆAPI å‘½åä¸è®¾è®¡ï¼‰**

---

## ğŸ§© ä¸€ã€æ•°æ®åº“å‘½åè§„èŒƒï¼ˆè¡¨ã€å­—æ®µã€ç±»å‹ï¼‰

### 1. æ€»ä½“åŸåˆ™

* **ç»Ÿä¸€é£æ ¼**ï¼šå…¨éƒ¨å°å†™ï¼Œå•è¯é—´ç”¨ä¸‹åˆ’çº¿ `_` åˆ†éš”ï¼ˆsnake_caseï¼‰ã€‚
* **è§åçŸ¥æ„**ï¼šåç§°åº”æ¸…æ™°è¡¨è¾¾ä¸šåŠ¡å«ä¹‰ã€‚
* **é¿å…ç¼©å†™**ï¼šé™¤éæ˜¯é€šç”¨ç¼©å†™ï¼ˆå¦‚ `id`, `url`, `ip`ï¼‰ã€‚
* **å•æ•°å‘½å**ï¼šè¡¨åä½¿ç”¨å•æ•°å½¢å¼ï¼Œå¦‚ `user` è€Œä¸æ˜¯ `users`ã€‚

---

### 2. è¡¨å‘½åè§„åˆ™

| ç±»å‹       | å‘½åè§„åˆ™                     | ç¤ºä¾‹                                 |
| -------- | ------------------------ | ---------------------------------- |
| ä¸»ä¸šåŠ¡è¡¨     | ä¸šåŠ¡å¯¹è±¡å                    | `user`, `order`, `product`         |
| å…³è”è¡¨ï¼ˆå¤šå¯¹å¤šï¼‰ | `ä¸»è¡¨_å‰¯è¡¨`                  | `user_role`, `student_course`      |
| æ—¥å¿—è¡¨      | `xxx_log`                | `operation_log`, `login_log`       |
| é…ç½®/å­—å…¸è¡¨   | `xxx_config`, `xxx_dict` | `system_config`, `error_code_dict` |

---

### 3. å­—æ®µå‘½åè§„åˆ™

| ç±»å‹   | å‘½åè§„åˆ™                         | ç¤ºä¾‹                        |
| ---- | ---------------------------- | ------------------------- |
| ä¸»é”®   | `id`                         | `id`                      |
| å¤–é”®   | `å…³è”è¡¨å_id`                    | `user_id`, `role_id`      |
| çŠ¶æ€å­—æ®µ | `xxx_status`ï¼ˆå€¼ç”¨æšä¸¾ï¼‰           | `order_status`            |
| æ—¶é—´å­—æ®µ | `created_at`, `updated_at` | å¸¸è§„å®¡è®¡å­—æ®µ                    |
| æ ‡å¿—å­—æ®µ | `is_xxx`ï¼Œç±»å‹ `tinyint(1)`     | `is_deleted`, `is_active` |

---

### 4. å­—æ®µç±»å‹å»ºè®®

| æ•°æ®ç±»å‹                     | ç”¨é€”      | è¯´æ˜                 |
| ------------------------ | ------- | ------------------ |
| `int` / `bigint`         | ä¸»é”®ã€è‡ªå¢ID | `bigint` æ¨èç”¨äºåˆ†å¸ƒå¼ID |
| `varchar(n)`             | å­—ç¬¦ä¸²     | ä¸€èˆ¬é•¿åº¦ `<=255`       |
| `text`                   | é•¿æ–‡æœ¬     | éæ£€ç´¢å­—æ®µ              |
| `datetime` / `timestamp` | æ—¶é—´      | æ¨èç»Ÿä¸€æ—¶åŒº             |
| `decimal(p,s)`           | é‡‘é¢      | é¿å…æµ®ç‚¹è¯¯å·®             |
| `tinyint(1)`             | å¸ƒå°”      | è¡¨ç¤º `true/false`    |

---

## ğŸ§  äºŒã€ä»£ç å‘½åè§„èŒƒ

### 1. é€šç”¨å‘½åé£æ ¼

| ç±»å‹      | é£æ ¼              | ç¤ºä¾‹                               |
| ------- | --------------- | -------------------------------- |
| å˜é‡ã€å‡½æ•°   | å°é©¼å³°ï¼ˆcamelCaseï¼‰  | `userName`, `getUserInfo()`      |
| ç±»ã€æ„é€ å‡½æ•°  | å¤§é©¼å³°ï¼ˆPascalCaseï¼‰ | `UserService`, `OrderController` |
| å¸¸é‡      | å…¨å¤§å†™ + ä¸‹åˆ’çº¿       | `MAX_RETRY_COUNT`                |
| åŒ… / æ¨¡å—å | å…¨å°å†™             | `user`, `order_service`          |

---

### 2. å˜é‡å‘½åå»ºè®®

* **å¸ƒå°”ç±»å‹**ï¼šç”¨ `is`, `has`, `can`, `should` å¼€å¤´
  ä¾‹å¦‚ï¼š`isActive`, `hasPermission`, `canDelete`
* **é›†åˆ/æ•°ç»„**ï¼šç”¨å¤æ•°å½¢å¼
  ä¾‹å¦‚ï¼š`users`, `orderList`
* **ä¸´æ—¶å˜é‡**ï¼šé¿å…ä½¿ç”¨ `a`, `b`, `tmp` ç­‰æ— æ„ä¹‰åç§°
* **ä¸Šä¸‹æ–‡æ˜ç¡®**ï¼šåç§°ä½“ç°å•ä½æˆ–èŒƒå›´ï¼Œå¦‚ï¼š`timeoutMs`, `priceCny`

---

### 3. å‡½æ•°/æ–¹æ³•å‘½åå»ºè®®

* åŠ¨è¯ + åè¯ç»“æ„ï¼Œå¦‚ï¼š

  * `getUserInfo()`
  * `updateOrderStatus()`
  * `calculateDiscount()`
* äº‹ä»¶å¤„ç†å‡½æ•°å¸¸ç”¨ `on` å¼€å¤´ï¼š

  * `onUserLogin()`, `onClickSubmit()`
* è¿”å›å¸ƒå°”å€¼çš„æ–¹æ³•ï¼šç”¨ `is/has/can` å¼€å¤´

  * `isValidUser()`, `hasPermission()`

---

### 4. ç±» / æ–‡ä»¶å‘½å

| ç±»å‹  | è§„åˆ™             | ç¤ºä¾‹                            |
| --- | -------------- | ----------------------------- |
| å®ä½“ç±» | åè¯             | `User`, `Order`               |
| æœåŠ¡ç±» | åŠ¨è¯+Service     | `UserService`, `EmailService` |
| æ§åˆ¶å™¨ | èµ„æºå+Controller | `UserController`              |
| å·¥å…·ç±» | åŠŸèƒ½å+Util       | `DateUtil`, `StringUtil`      |

---

## ğŸŒ ä¸‰ã€API å‘½åè§„èŒƒ

### ğŸ§© ä¸€ã€å‘½ååŸåˆ™

| è§„åˆ™             | ç¤ºä¾‹                                   | è¯´æ˜                           |
| -------------- | ------------------------------------ | ---------------------------- |
| **ç»Ÿä¸€ä½¿ç”¨å°å†™è‹±æ–‡å­—æ¯** | `/users`, `/orders`                  | è·¯å¾„åŒºåˆ†å¤§å°å†™ï¼Œé¿å…æ··ä¹±                 |
| **å•è¯ç”¨ä¸­åˆ’çº¿åˆ†éš”**   | `/user-orders`, `/reset-password`    | æ¨èä½¿ç”¨ `kebab-case`ï¼ˆREST ç¤¾åŒºé€šç”¨ï¼‰ |
| **èµ„æºä½¿ç”¨åè¯å¤æ•°å½¢å¼** | `/users`, `/products`                | è¡¨ç¤ºèµ„æºé›†åˆ                       |
| **é¿å…åŠ¨è¯**       | âŒ `/getUser`, âœ… `/users/{id}`        | REST åŠ¨è¯ç”± HTTP æ–¹æ³•è¡¨è¾¾           |
| **åŠ¨ä½œç”¨å­è·¯å¾„è¡¨è¾¾**   | `/auth/login`, `/orders/{id}/cancel` | åŠ¨ä½œæ˜¯å¯¹èµ„æºçš„æ“ä½œ                    |

---

### ğŸ§  äºŒã€HTTP æ–¹æ³•è¯­ä¹‰

| HTTP æ–¹æ³•  | è¯´æ˜        | ç¤ºä¾‹                     |
| -------- | --------- | ---------------------- |
| `GET`    | è·å–èµ„æº      | `/users`ã€`/users/{id}` |
| `POST`   | åˆ›å»ºèµ„æºæˆ–è§¦å‘è¡Œä¸º | `/users`ã€`/auth/login` |
| `PUT`    | æ›´æ–°èµ„æºï¼ˆæ•´ä½“ï¼‰  | `/users/{id}`          |
| `PATCH`  | æ›´æ–°èµ„æºï¼ˆéƒ¨åˆ†ï¼‰  | `/users/{id}`          |
| `DELETE` | åˆ é™¤èµ„æº      | `/users/{id}`          |

---

### ğŸ“š ä¸‰ã€èµ„æºå‘½åè§„èŒƒ

| èµ„æºç±»å‹  | å‘½åè§„èŒƒ   | ç¤ºä¾‹                               |
| ----- | ------ | -------------------------------- |
| ä¸»è¦èµ„æº  | å¤æ•°åè¯   | `/users`, `/orders`, `/products` |
| å­èµ„æº   | å±‚çº§è·¯å¾„   | `/users/{id}/orders`             |
| è¿‡æ»¤ã€æŸ¥è¯¢ | ä½¿ç”¨æŸ¥è¯¢å‚æ•° | `/users?status=active&page=1`    |
| ç‰ˆæœ¬æ§åˆ¶  | æ”¾åœ¨è·¯å¾„å‰ç¼€ | `/api/v1/users`                  |

---

### ğŸ” å››ã€è®¤è¯ä¸æˆæƒï¼ˆAuthï¼‰å‘½åè§„èŒƒ

`auth`ã€`login`ã€`token` ç­‰é€šå¸¸ä¸æ˜¯èµ„æºé›†åˆï¼Œè€Œæ˜¯**è¡Œä¸ºç±»æ¥å£**ã€‚
å› æ­¤æ¨èä½¿ç”¨å•æ•°å‘½åç©ºé—´ï¼Œä¸åŠ  â€œsâ€ã€‚

| åŠŸèƒ½            | æ¨èè·¯å¾„                                        | è¯´æ˜                |
| ------------- | ------------------------------------------- | ----------------- |
| ç™»å½•            | `POST /auth/login`                          | ä½¿ç”¨ç”¨æˆ·åã€å¯†ç ç­‰å‡­è¯ç™»å½•     |
| ç™»å‡º            | `POST /auth/logout`                         | æ¸…é™¤ Token æˆ–ä¼šè¯      |
| åˆ·æ–° Token      | `POST /auth/refresh`                        | ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæ¢å–æ–° Token   |
| æ³¨å†Œ            | `POST /auth/register`                       | åˆ›å»ºç”¨æˆ·              |
| è·å–å½“å‰ç”¨æˆ·        | `GET /me` æˆ– `GET /users/me`                 | é€šè¿‡å½“å‰ Token è·å–ç”¨æˆ·ä¿¡æ¯ |
| ç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆOAuth2ï¼‰ | `GET /oauth/authorize`, `POST /oauth/token` | éµå¾ª OAuth2 æ ‡å‡†æ¥å£å‘½å  |

> âš ï¸ ä¸å»ºè®®ä½¿ç”¨ `/auths`
> å› ä¸º â€œauthâ€ è¡¨ç¤ºè¡Œä¸ºæˆ–è¿‡ç¨‹ï¼ˆä¸å¯æ•°ï¼‰ï¼Œä¸æ˜¯èµ„æºé›†åˆã€‚

---

### ğŸ§© äº”ã€åŠ¨ä½œï¼ˆé CRUDï¼‰å‘½åè§„èŒƒ

æœ‰æ—¶éœ€è¦è¡¨ç¤ºéæ ‡å‡† CRUD æ“ä½œï¼Œä¾‹å¦‚ï¼š

* â€œæäº¤è®¢å•â€
* â€œå–æ¶ˆè®¢å•â€
* â€œé‡ç½®å¯†ç â€

æ¨èç”¨ **å­è·¯å¾„ + åŠ¨è¯** è¡¨è¾¾åŠ¨ä½œï¼š

| åŠŸèƒ½      | æ¨èè·¯å¾„                                                    | è¯´æ˜      |
| ------- | ------------------------------------------------------- | ------- |
| å–æ¶ˆè®¢å•    | `POST /orders/{id}/cancel`                              | åŠ¨è¯ä½œä¸ºå­è·¯å¾„ |
| æäº¤è®¢å•    | `POST /orders/{id}/submit`                              | å­åŠ¨ä½œ     |
| é‡ç½®å¯†ç     | `POST /users/{id}/reset-password`                       | æ˜ç¡®åŠ¨ä½œè¯­ä¹‰  |
| å¯ç”¨/ç¦ç”¨ç”¨æˆ· | `PATCH /users/{id}/enable`, `PATCH /users/{id}/disable` | çŠ¶æ€åˆ‡æ¢    |

---

### ğŸ’¡ å…­ã€å“åº”æ ¼å¼è§„èŒƒ

ç»Ÿä¸€çš„ JSON å“åº”ç»“æ„æœ‰åŠ©äºå‰ç«¯è§£æä¸é”™è¯¯å¤„ç†ã€‚

```json
{
  "code": 0,
  "message": "success",
  "data": { ... }
}
```

å»ºè®®ï¼š

| å­—æ®µ        | å«ä¹‰          | ç¤ºä¾‹                           |
| --------- | ----------- | ---------------------------- |
| `code`    | çŠ¶æ€ç ï¼ˆ0 è¡¨ç¤ºæˆåŠŸï¼‰ | `1001`ï¼šä¸šåŠ¡é”™è¯¯                  |
| `message` | äººç±»å¯è¯»æ¶ˆæ¯      | `"Invalid token"`            |
| `data`    | è¿”å›æ•°æ®å¯¹è±¡      | `{ "id": 1, "name": "Tom" }` |

---

### ğŸ§­ ä¸ƒã€åˆ†é¡µä¸æŸ¥è¯¢å‚æ•°è§„èŒƒ

| å‚æ•°å        | å«ä¹‰   | ç¤ºä¾‹                       |
| ---------- | ---- | ------------------------ |
| `page`     | é¡µç    | `?page=2`                |
| `pageSize` | æ¯é¡µæ•°é‡ | `?pageSize=20`           |
| `sort`     | æ’åºå­—æ®µ | `?sort=createdAt,desc` |
| `filter`   | è¿‡æ»¤æ¡ä»¶ | `?status=active`         |

ç¤ºä¾‹ï¼š

```http
GET /users?page=2&pageSize=20&sort=createdAt,desc&status=active
```

---

## ğŸ“˜ å…«ã€å‘½åé£æ ¼ç¤ºä¾‹æ±‡æ€»

| åŠŸèƒ½       | è·¯å¾„ç¤ºä¾‹                                             |
| -------- | ------------------------------------------------ |
| ç”¨æˆ·ç®¡ç†     | `/users`, `/users/{id}`, `/users/me`             |
| ç™»å½•/ç™»å‡º    | `/auth/login`, `/auth/logout`                    |
| Token åˆ·æ–° | `/auth/refresh`                                  |
| æ³¨å†Œ       | `/auth/register`                                 |
| è®¢å•æ“ä½œ     | `/orders`, `/orders/{id}`, `/orders/{id}/cancel` |
| æ–‡ä»¶ä¸Šä¼      | `/files` (POST ä¸Šä¼ )                               |
| ç³»ç»Ÿé…ç½®     | `/configs`, `/configs/{key}`                     |

---

## âœ… ä¹ã€å‘½åå°ç»“

| é¡¹ç›®   | å‘½åè§„èŒƒ                | ç¤ºä¾‹                         |
| ---- | ------------------- | -------------------------- |
| èµ„æºå  | åè¯å¤æ•°                | `/users`, `/orders`        |
| åŠ¨ä½œ   | å­è·¯å¾„åŠ¨è¯               | `/orders/{id}/cancel`      |
| è®¤è¯è¡Œä¸º | å•æ•°å‘½åç©ºé—´              | `/auth/login`ï¼ˆä¸è¦ `/auths`ï¼‰ |
| æŸ¥è¯¢   | æŸ¥è¯¢å‚æ•°                | `/users?status=active`     |
| å½“å‰ç”¨æˆ· | `/me` æˆ– `/users/me` |                            |


